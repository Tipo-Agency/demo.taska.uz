# Архитектура системы tipa.taska.uz

## 1. Общая архитектура

### 1.1. Тип системы
**Корпоративная CRM/ERP система** с модульной архитектурой:
- Управление задачами
- CRM (клиенты, сделки, воронки)
- Финансовое планирование
- HR (сотрудники, бизнес-процессы)
- Документооборот
- Встречи и календарь
- Контент-планирование

### 1.2. Предполагаемый рост
- Новые модули (инвентарь, склад, производство)
- Интеграции (Telegram, Instagram, платежные системы)
- Мобильные приложения (iOS, Android)
- PWA для офлайн-работы
- Мультитенантность
- API для внешних интеграций

### 1.3. Разделение на уровни

```
┌─────────────────────────────────────────────────────────────┐
│                    PRESENTATION LAYER                       │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │   Pages      │  │  Components  │  │   Layouts     │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
└─────────────────────────────────────────────────────────────┘
                            │
┌─────────────────────────────────────────────────────────────┐
│                    BUSINESS LOGIC LAYER                      │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │    Hooks     │  │   Services   │  │   Utils      │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
└─────────────────────────────────────────────────────────────┘
                            │
┌─────────────────────────────────────────────────────────────┐
│                      DATA LAYER                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │   Backend    │  │  Firestore   │  │   Storage    │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
└─────────────────────────────────────────────────────────────┘
                            │
┌─────────────────────────────────────────────────────────────┐
│                  INFRASTRUCTURE LAYER                        │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │  Firebase    │  │  Telegram    │  │   External   │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
└─────────────────────────────────────────────────────────────┘
```

## 2. Структура компонентов

### 2.1. Иерархия компонентов

```
components/
├── ui/                          # Базовые UI-компоненты (переиспользуемые)
│   ├── buttons/                 # Все типы кнопок
│   ├── inputs/                  # Поля ввода
│   ├── modals/                  # Модальные окна
│   ├── cards/                   # Карточки
│   ├── tables/                  # Таблицы
│   ├── navigation/              # Навигация
│   ├── feedback/                # Уведомления, тосты
│   └── layout/                  # Контейнеры, сетки
│
├── features/                    # Функциональные компоненты
│   ├── tasks/                   # Компоненты задач
│   ├── deals/                   # Компоненты сделок
│   ├── clients/                 # Компоненты клиентов
│   ├── finance/                 # Финансовые компоненты
│   └── ...
│
├── modules/                     # Модули (композиция features)
│   ├── TasksModule/
│   ├── CRMModule/
│   ├── FinanceModule/
│   └── ...
│
├── layouts/                     # Макеты страниц
│   ├── AppLayout/
│   ├── AuthLayout/
│   └── PublicLayout/
│
└── pages/                       # Страницы (только композиция)
    ├── HomePage/
    ├── TasksPage/
    └── ...
```

### 2.2. Принципы компонентности

1. **Атомарность**: Каждый компонент решает одну задачу
2. **Переиспользование**: Компонент используется минимум в 2 местах
3. **Изоляция**: Компонент не знает о контексте использования
4. **Композиция**: Сложные компоненты собираются из простых

## 3. Разделение ответственности

### 3.1. Pages (Страницы)
- **НЕ содержат** бизнес-логику
- **НЕ содержат** сложную разметку
- **ТОЛЬКО** собирают компоненты и передают данные

### 3.2. Components (Компоненты)
- **Содержат** только логику отображения
- **Получают** данные через props
- **Вызывают** callbacks для действий

### 3.3. Hooks (Хуки)
- **Содержат** бизнес-логику
- **Управляют** состоянием
- **Работают** с данными

### 3.4. Services (Сервисы)
- **Работают** с внешними API
- **Обрабатывают** данные
- **Не зависят** от UI

## 4. Мобильная адаптация

### 4.1. Safe Areas
- Использование CSS переменных для safe-area-inset
- Отступы для системных элементов (iOS, Android, Telegram Web App)

### 4.2. Адаптивность
- Mobile-first подход
- Breakpoints: sm (640px), md (768px), lg (1024px), xl (1280px)
- Touch-friendly интерфейсы (минимум 44x44px для кликабельных элементов)

### 4.3. Производительность
- Ленивая загрузка компонентов
- Виртуализация списков
- Оптимизация изображений

## 5. Документация компонентов

Каждый компонент должен иметь:
- Описание назначения
- Props интерфейс
- Примеры использования
- Состояния (loading, error, empty)
- Варианты использования
