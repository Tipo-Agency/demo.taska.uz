# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –ú–æ–¥—É–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Notifications Module)

## 1. –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### 1.1. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ú–æ–¥—É–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–∞–Ω–∞–ª—ã (Activity Logs, Telegram).

### 1.2. –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã
- **Activity Logs** - –í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Telegram** - –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## 2. –ö–∞–Ω–∞–ª—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### 2.1. Activity Logs (–°–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)

#### 2.1.1. –í—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω—ã
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ –≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —Ç–∏–ø—É –¥–µ–π—Å—Ç–≤–∏—è, –¥–∞—Ç–µ

#### 2.1.2. –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–¥–∞—á–µ
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–∫–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–¥–∏–∏ —Å–¥–µ–ª–∫–∏
- –ò –¥—Ä—É–≥–∏–µ —Å–æ–±—ã—Ç–∏—è —Å–∏—Å—Ç–µ–º—ã

### 2.2. Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### 2.2.1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏
- **telegramPersonal** (boolean) - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –ª–∏—á–Ω—ã–π —á–∞—Ç
- **telegramGroup** (boolean) - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É

#### 2.2.2. –ü–æ–ª—É—á–∞—Ç–µ–ª–∏
- –õ–∏—á–Ω—ã–π —á–∞—Ç: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º `telegramUserId`
- –ì—Ä—É–ø–ø–∞: —á–∞—Ç —Å ID –∏–∑ `telegramGroupChatId`

## 3. –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

### 3.1. –ó–∞–¥–∞—á–∏ (Tasks)
- **newTask** - –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞
- **statusChange** - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- **taskAssigned** - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
- **taskComment** - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–¥–∞—á–µ
- **taskDeadline** - –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –¥–µ–¥–ª–∞–π–Ω–∞

### 3.2. CRM
- **dealCreated** - –ù–æ–≤–∞—è —Å–¥–µ–ª–∫–∞
- **dealStatusChanged** - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–¥–∏–∏ —Å–¥–µ–ª–∫–∏
- **clientCreated** - –ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç
- **contractCreated** - –ù–æ–≤—ã–π –¥–æ–≥–æ–≤–æ—Ä

### 3.3. –ö–æ–Ω—Ç–µ–Ω—Ç
- **docCreated** - –ù–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
- **meetingCreated** - –ù–æ–≤–∞—è –≤—Å—Ç—Ä–µ—á–∞

### 3.4. –§–∏–Ω–∞–Ω—Å—ã
- **purchaseRequestCreated** - –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É

## 4. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å

### 4.1. notificationService.ts

#### 4.1.1. –§—É–Ω–∫—Ü–∏–∏
- `notifyTaskCreated` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏
- `notifyTaskStatusChanged` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞
- `notifyDealCreated` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–¥–µ–ª–∫–∏
- `notifyDealStatusChanged` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞–¥–∏–∏
- `notifyClientCreated` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
- `notifyContractCreated` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–∞
- `notifyDocCreated` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `notifyMeetingCreated` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤—Å—Ç—Ä–µ—á–∏
- `notifyPurchaseRequestCreated` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏

#### 4.1.2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
```typescript
{
  context: {
    currentUser: User;
    allUsers: User[];
    notificationPrefs?: NotificationPreferences;
  }
}
```

### 4.2. activityLogUtils.ts

#### 4.2.1. –§—É–Ω–∫—Ü–∏–∏
- `createActivityLog` - –°–æ–∑–¥–∞—Ç—å –ª–æ–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- `createActivityLogsForAll` - –°–æ–∑–¥–∞—Ç—å –ª–æ–≥–∏ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `createTaskCreatedLog` - –õ–æ–≥ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
- `createTaskStatusChangedLog` - –õ–æ–≥ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
- –ò –¥—Ä—É–≥–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 4.3. telegramService.ts

#### 4.3.1. –§—É–Ω–∫—Ü–∏–∏
- `sendTelegramNotification` - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram
- `getUserTelegramChatId` - –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `sendTelegramMessage` - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram

## 5. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

### 5.1. –§–æ—Ä–º–∞—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π
- HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Telegram
- –≠–º–æ–¥–∑–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è
- –ö–Ω–æ–ø–∫–∏ –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π

### 5.2. –ü—Ä–∏–º–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π
- "‚úÖ –°–æ–∑–¥–∞–Ω–∞ –∑–∞–¥–∞—á–∞: [–ù–∞–∑–≤–∞–Ω–∏–µ]"
- "üîÑ –ò–∑–º–µ–Ω–µ–Ω —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏: [–°—Ç–∞—Ç—É—Å] ‚Üí [–ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å]"
- "üí∞ –ù–æ–≤–∞—è —Å–¥–µ–ª–∫–∞: [–ù–∞–∑–≤–∞–Ω–∏–µ] –Ω–∞ —Å—É–º–º—É [–°—É–º–º–∞]"

## 6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 6.1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥—É–ª—è–º–∏
- –í—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 6.2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram –±–æ—Ç–æ–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–≥–æ –∂–µ API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## 7. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### 7.1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[NOTIFICATION]`
- –û—à–∏–±–∫–∏ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏
- –ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

### 7.2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É
- –û—á–µ—Ä–µ–¥—å –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### 7.3. –ö–æ–ª–ª–µ–∫—Ü–∏–∏ Firestore
- `activity` - –õ–æ–≥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ)
