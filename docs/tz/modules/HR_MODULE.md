# Техническое задание: Модуль HR

## 1. Общая информация

### 1.1. Назначение
Модуль HR предназначен для управления сотрудниками, отделами, должностями и бизнес-процессами.

### 1.2. Компоненты модуля
- **Сотрудники** - Информация о сотрудниках
- **Отделы** - Управление отделами (интеграция с Finance модулем)
- **Должности** - Организационная структура
- **Бизнес-процессы** - Автоматизация рабочих процессов

## 2. Сотрудники (Employees)

### 2.1. Создание сотрудника

#### 2.1.1. Обязательные поля
- **userId** (string) - ID пользователя (связь с users)
- **position** (string) - Должность

#### 2.1.2. Опциональные поля
- **departmentId** (string) - ID отдела
- **hireDate** (string) - Дата найма (YYYY-MM-DD)
- **birthDate** (string) - Дата рождения (YYYY-MM-DD)

### 2.2. Управление сотрудниками
- Просмотр списка сотрудников
- Редактирование информации
- Связь с пользователем (userId)
- Мягкое удаление (архив)
- Восстановление из архива

## 3. Должности (Org Positions)

### 3.1. Создание должности

#### 3.1.1. Обязательные поля
- **title** (string) - Название должности

#### 3.1.2. Опциональные поля
- **departmentId** (string) - ID отдела
- **managerPositionId** (string) - ID должности руководителя
- **holderUserId** (string) - ID пользователя, занимающего должность
- **order** (number) - Порядок для отображения (меньше = левее)

### 3.2. Организационная структура
- Иерархия должностей
- Связь с отделами
- Назначение сотрудников на должности

## 4. Бизнес-процессы (Business Processes)

### 4.1. Создание процесса

#### 4.1.1. Обязательные поля
- **title** (string) - Название процесса
- **steps** (ProcessStep[]) - Шаги процесса

#### 4.1.2. Шаг процесса (ProcessStep)
```typescript
{
  id: string;
  title: string;
  description?: string;
  assigneeType: 'user' | 'position';  // Тип исполнителя
  assigneeId: string;                 // ID пользователя или должности
  order: number;                       // Порядок выполнения
}
```

### 4.2. Запуск процесса

#### 4.2.1. Экземпляр процесса (ProcessInstance)
```typescript
{
  id: string;
  processId: string;
  processVersion: number;             // Версия процесса на момент запуска
  currentStepId: string | null;       // Текущий активный шаг
  status: 'active' | 'completed' | 'paused';
  startedAt: string;                  // ISO дата запуска
  completedAt?: string;                // ISO дата завершения
  taskIds: string[];                   // ID задач процесса
}
```

### 4.3. Автоматизация процесса
- При запуске процесса автоматически создаются задачи для каждого шага
- При изменении статуса задачи автоматически обновляется статус процесса
- При завершении всех шагов процесс автоматически завершается

### 4.4. Интеграция с Tasks модулем
- Автоматическое создание задач при запуске процесса
- Связь задачи с процессом (`processId`, `processInstanceId`, `stepId`)
- Автоматическое обновление статуса процесса при изменении статуса задачи

## 5. Интеграции

### 5.1. Интеграция с Finance модулем
- Связь с отделами
- Использование отделов в бизнес-процессах

### 5.2. Интеграция с Tasks модулем
- Автоматическое создание задач из бизнес-процессов
- Отслеживание выполнения процесса через задачи

### 5.3. Интеграция с Notifications модулем
- Уведомления о запуске процесса
- Уведомления о завершении шага
- Уведомления о необходимости согласования

## 6. Технические детали

### 6.1. Компоненты
- `HRModule` - Основной компонент модуля
- `EmployeesView` - Представление сотрудников
- `DepartmentsView` - Представление отделов
- `BusinessProcessesView` - Представление бизнес-процессов

### 6.2. API Endpoints
- `GET /api/employees` - Получить всех сотрудников
- `POST /api/employees` - Создать сотрудника
- `PUT /api/employees/:id` - Обновить сотрудника
- `DELETE /api/employees/:id` - Удалить сотрудника
- `GET /api/bpm/positions` - Получить все должности
- `POST /api/bpm/positions` - Создать должность
- `GET /api/bpm/processes` - Получить все процессы
- `POST /api/bpm/processes` - Создать процесс

### 6.3. Коллекции Firestore
- `employeeInfos` - Информация о сотрудниках
- `orgPositions` - Должности
- `businessProcesses` - Бизнес-процессы
